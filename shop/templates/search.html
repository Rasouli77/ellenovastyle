{% extends 'base.html' %}
{% load static %}
{% block title %}
	جست و جو
{% endblock %}
{% block meta_description %}
	جست و جو
{% endblock %}
{% block content %}
{% if products %}
<!-- breadcrumb__start -->
<div class="breadcrumb">
	<div class="container">
		<div class="row">
			<div class="col-xl-12">
				<div class="breadcrumb__title">
					<h1>نتایج برای "{{ search_term }}":</h1>
				</div>
			</div>
		</div>
	</div>
</div>
 <!-- breadcrumb__end -->
 <div class="shop sp_top_80">
	<div class="container">
		<div class="row grid__responsive">
			<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
				<div class="shop__right__wraper"  id="store-options">
					<button type="button" class="default__button sidebar-collapse-btn" id="filter-btn" data-aos="fade-up" data-aos-duration="1800">
						<svg xmlns="http://www.w3.org/2000/svg" height="24" viewbox="0 0 32 32" width="24"><g id="Layer_2" data-name="Layer 2"><path d="m28.552 6.184h-2.671a4.556 4.556 0 0 0 -8.659 0h-13.774a1.449 1.449 0 0 0 0 2.9h13.774a4.556 4.556 0 0 0 8.659 0h2.671a1.449 1.449 0 0 0 0-2.9zm-7 3.138a1.69 1.69 0 1 1 1.689-1.69 1.692 1.692 0 0 1 -1.689 1.69z"></path><path d="m28.552 14.552h-13.774a4.556 4.556 0 0 0 -8.659 0h-2.671a1.448 1.448 0 0 0 0 2.9h2.671a4.556 4.556 0 0 0 8.659 0h13.774a1.448 1.448 0 0 0 0-2.9zm-18.1 3.138a1.69 1.69 0 1 1 1.686-1.69 1.692 1.692 0 0 1 -1.69 1.69z"></path><path d="m28.552 22.919h-2.671a4.556 4.556 0 0 0 -8.659 0h-13.774a1.449 1.449 0 0 0 0 2.9h13.774a4.556 4.556 0 0 0 8.659 0h2.671a1.449 1.449 0 0 0 0-2.9zm-7 3.138a1.69 1.69 0 1 1 1.689-1.689 1.692 1.692 0 0 1 -1.689 1.689z"></path></g></svg>
						فیلتر
					</button>
					<div class="shop__selecte">
						<select class="nice-select" name="SortBy" id="SortBy">
							
							<option value="">ترتیب نمایش</option>
							<option value="lowest_to_highest">قیمت، کم به زیاد</option>
							<option value="highest_to_lowest">قیمت، زیاد به کم</option>
							<option value="new_to_old">تاریخ، جدید به قدیم</option>
							<option value="old_to_new">تاریخ، قدیم به جدید</option>
							</select>
					</div>
					<form action="" method="get" id="sortForm"></form>
				</div>
				<div class="tab-content " id="myTabContent">
					<div class="tab-pane fade active show" id="projects__one" role="tabpanel" aria-labelledby="projects__one">
						<div class="row grid__responsive">
							{% for product_data in products_data %}
							{% if product_data.product.status %}
							<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 col-6">
								<div class="grid__wraper">
									<div class="grid__wraper__img">
										<div class="grid__wraper__img__inner">
										    {% if product_data.product.product_slug %}
											<a href="{% url 'product' product_slug=product_data.product.product_slug %}">
											{% endif %}
											{% if product_data.product.image and product_data.product.image.url %}
												<img class="primary__image" src="{{ product_data.product.image_optimized.url }}" alt="خرید و قیمت {{ product_data.product.title }}">
											{% endif %}
											{% if product_data.product_image_url.image.url %}
												<img class="secondary__image" src="{{ product_data.product.image_optimized_two.url }}" alt="خرید و قیمت {{ product_data.product.title }}">
												{% endif %}
											</a>
										</div>
										<div class="grid__wraper__badge">
											{% if product_data.product_size.discount_percent > 0 %}
											<span class="sale__badge">{{product_data.product_size.discount_percent}}%-</span>
											{% endif %}
										</div>
									</div>
									<div class="grid__wraper__info">
									    {% if product_data.product.title %}
										<h3 class="grid__wraper__tittle">
										    {% if product_data.product.product_slug %}
											<a href="{% url 'product' product_slug=product_data.product.product_slug %}" tabindex="0">{{ product_data.product.title }}</a>
											{% endif %}
										</h3>
										{% endif %}
										<div class="grid__wraper__price">
											{% if product_data.product_size.discount_percent > 0 %}
											<span><span class="product-price">{{ product_data.product_size.discount_price }}</span> تومان</span>
											<del><span class="product-price">{{ product_data.product_size.price }}</span> تومان</del>
											{% else %}
											<span><span class="product-price">{{ product_data.product_size.price }}</span> تومان</span>
											{% endif %} 
										</div>
									</div>
								</div>
							</div>
							{% endif %}
							{% endfor %}
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% else %}
<div class="single__product__contact sp_bottom_80" id="contact-us">
    <div class="container">
        <div class="row">
            <div class="col-xl-12">
                <div class="single__product__contact__text text-center">
                    <h2>نتیجه ای یافت نشد</h2>
                </div>
            </div>
        </div>
    </div>
 </div>
{% endif %}
<!-- Price Separator -->
<script>
	document.addEventListener("DOMContentLoaded", () => {
        const productPrice = document.querySelectorAll(".product-price");
        productPrice.forEach(productElement => {
            let rawProductPrice = productElement.innerHTML;
            let formattedPrice = parseInt(rawProductPrice).toLocaleString();
            productElement.innerHTML = formattedPrice;
        })
    })
</script>
	
{% endblock %}

		